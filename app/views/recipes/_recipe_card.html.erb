<%# Recipe Card for Grid View - Supports dynamic height with/without images %>

<%= link_to recipe, class: "group bg-surface-overlay dark:bg-gray-800 rounded-lg border border-border-subtle dark:border-gray-700 shadow-sm hover:shadow-md hover:border-brand-primary/30 dark:hover:border-amber-700/30 transition-all cursor-pointer flex flex-col relative min-h-[156px] w-full", data: { testid: "recipe-card-#{recipe.id}" } do %>
  <%# Note: Cards with images will be 156px + 160px (h-40) = 316px tall %>

  <%# Overlay Action Buttons - Always visible on mobile, hover on desktop %>
  <%= render "recipes/favorite_button", recipe: recipe, context: :card %>

  <%# Image Area - Only render if image exists %>
  <%# TODO: Add image_url field to recipes table %>
  <% if false %>
    <div class="h-48 md:h-40 bg-gray-100 dark:bg-gray-700 relative overflow-hidden rounded-t-lg">
      <%# <%= image_tag recipe.image_url, alt: recipe.name, class: "w-full h-full object-cover group-hover:scale-105 transition-transform duration-500" %>
    </div>
  <% end %>

  <%# Content Area %>
  <div class="p-4 flex flex-col flex-1">
    <%# Tags - Show first tag or "Recipe" if no tags %>
    <div class="flex justify-between items-start mb-2">
      <% if recipe.tags.any? %>
        <span class="text-[10px] font-bold uppercase tracking-wider text-brand-primary dark:text-amber-500 bg-brand-primary/10 dark:bg-amber-500/10 px-2 py-0.5 rounded-sm">
          <%= recipe.tags.first.name %>
        </span>
      <% else %>
        <span class="text-[10px] font-bold uppercase tracking-wider text-gray-400 dark:text-gray-600 bg-gray-100 dark:bg-gray-800 px-2 py-0.5 rounded-sm">
          Recipe
        </span>
      <% end %>
    </div>

    <%# Recipe Title %>
    <h3 class="text-lg font-bold text-text-primary dark:text-gray-100 leading-snug mb-1 line-clamp-2">
      <%= recipe.name %>
    </h3>

    <%# Recipe Notes Preview %>
    <p class="text-text-secondary dark:text-gray-400 text-xs line-clamp-4 mb-4">
      <%= recipe.notes || "No notes available." %>
    </p>

    <%# Footer Metadata - Only show if time data exists %>
    <% total_time = (recipe.prep_time || 0) + (recipe.cook_time || 0) %>
    <% if total_time > 0 %>
      <div class="flex items-center justify-between text-xs text-text-tertiary dark:text-gray-500 font-medium pt-3 border-t border-gray-100 dark:border-gray-700 mt-auto">
        <div class="flex items-center gap-1">
          <%= lucide_icon "clock", class: "size-3" %>
          <span><%= total_time %>m</span>
        </div>
      </div>
    <% end %>
  </div>
<% end %>
