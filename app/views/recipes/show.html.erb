<% content_for :title, @recipe.name %>

<div class="flex flex-col h-full">
  <%# Header Bar - Sticky on mobile %>
  <div class="sticky top-0 z-20 bg-surface-base/95 dark:bg-gray-950/95 backdrop-blur-sm border-b border-border-subtle dark:border-gray-800">
    <div class="flex items-center justify-between px-4 py-3 md:px-6 md:py-4">
      <%# Left: Back button %>
      <%= link_to recipes_path, class: "flex items-center gap-2 text-text-secondary dark:text-gray-400 hover:text-text-primary dark:hover:text-gray-200 transition-colors", data: { testid: "back-to-recipes-link" } do %>
        <%= lucide_icon "chevron-left", class: "size-5" %>
        <span class="hidden sm:inline text-sm font-medium">Back to recipes</span>
      <% end %>

      <%# Right: Actions %>
      <div class="flex items-center gap-2">
        <%# Favorite Button %>
        <div id="recipe_<%= @recipe.id %>_favorite">
          <%= button_to toggle_favorite_recipe_path(@recipe), method: :patch, class: "p-2 rounded-md text-text-secondary dark:text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors cursor-pointer" do %>
            <%= lucide_icon "heart", class: "size-5 #{@recipe.favorite? ? 'fill-red-500 text-red-500' : ''}" %>
          <% end %>
        </div>

        <%# Edit Button %>
        <%= link_to edit_recipe_path(@recipe), class: "p-2 rounded-md text-text-secondary dark:text-gray-400 hover:text-brand-primary dark:hover:text-amber-500 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors", data: { testid: "edit-recipe-link" } do %>
          <%= lucide_icon "pencil", class: "size-5" %>
        <% end %>

        <%# Delete Button %>
        <%= button_to @recipe, method: :delete, data: { turbo_confirm: "Are you sure you want to delete this recipe?", testid: "delete-recipe-button" }, class: "p-2 rounded-md text-text-secondary dark:text-gray-400 hover:text-red-500 dark:hover:text-red-400 hover:bg-gray-100 dark:hover:bg-gray-800 transition-colors cursor-pointer" do %>
          <%= lucide_icon "trash-2", class: "size-5" %>
        <% end %>
      </div>
    </div>
  </div>

  <%# Content Area %>
  <div class="flex-1 overflow-y-auto">
    <%# Flash Notice %>
    <% if notice.present? %>
      <div class="mx-4 mt-4 md:mx-6 flex items-center gap-2 bg-green-50 dark:bg-green-900/20 border border-green-200 dark:border-green-800 text-green-800 dark:text-green-200 px-4 py-3 rounded-md">
        <svg xmlns="http://www.w3.org/2000/svg" class="stroke-current shrink-0 h-5 w-5" fill="none" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>
        <span class="text-sm"><%= notice %></span>
      </div>
    <% end %>

    <%# Recipe Content %>
    <div class="p-4 md:p-6 pb-8">
      <%= render @recipe %>
    </div>
  </div>
</div>
