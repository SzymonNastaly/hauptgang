<%# Mobile Sidebar Drawer (Mobile Only) %>
<div class="md:hidden">
  <%# Backdrop - Fixed in place, fades in/out %>
  <div
    data-mobile-nav-target="backdrop"
    data-action="click->mobile-nav#closeSidebar"
    class="fixed inset-0 z-50 bg-black/20 backdrop-blur-sm opacity-0 transition-opacity duration-300 pointer-events-none"
  ></div>

  <%# Drawer Content - Slides in from left %>
  <div
    data-mobile-nav-target="drawer"
    class="hidden fixed inset-y-0 left-0 z-50 w-[260px] bg-surface-base dark:bg-gray-950 shadow-xl flex-col h-full border-r border-border-subtle dark:border-gray-800 transform -translate-x-full transition-transform duration-300 ease-in-out"
  >

    <%# Drawer Header %>
    <div class="h-16 flex items-center justify-between px-3 border-b border-border-subtle dark:border-gray-800 bg-surface-raised dark:bg-gray-900">
      <div class="flex items-center gap-3">
        <div class="w-8 h-8 bg-brand-primary dark:bg-amber-700 rounded-md flex items-center justify-center text-white shadow-sm">
          <%= lucide_icon "book-open", class: "size-4" %>
        </div>
        <span class="font-bold text-lg text-gray-900 dark:text-gray-100">Hauptgang</span>
      </div>
      <button
        data-action="click->mobile-nav#closeSidebar"
        class="text-gray-400 dark:text-gray-500 hover:text-gray-900 dark:hover:text-gray-100 transition-colors"
        aria-label="Close menu"
      >
        <%= lucide_icon "x", class: "size-6" %>
      </button>
    </div>

    <%# Navigation List - No extra padding on container %>
    <div class="flex-1 overflow-y-auto">
      <%# Home Link %>
      <%= link_to recipes_path,
        data: { action: "click->mobile-nav#closeSidebar" },
        class: "w-full flex items-center gap-4 px-3 py-3 text-base font-medium transition-all border-b border-gray-50 dark:border-gray-800/50 #{current_page?(recipes_path) && params[:view] != 'favorites' ? 'bg-brand-primary/5 dark:bg-amber-500/5 text-brand-primary dark:text-amber-500 border-brand-primary/10 dark:border-amber-500/10' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 hover:text-gray-700 dark:hover:text-gray-100'}" do %>
        <%= lucide_icon "home", class: "size-5 #{current_page?(recipes_path) && params[:view] != 'favorites' ? 'text-brand-primary dark:text-amber-500' : 'text-gray-400 dark:text-gray-500'}", stroke_width: (current_page?(recipes_path) && params[:view] != 'favorites' ? 2.5 : 2) %>
        <span>Home</span>
      <% end %>

      <%# Favorites Link %>
      <%= link_to recipes_path(view: 'favorites'),
        data: { action: "click->mobile-nav#closeSidebar" },
        class: "w-full flex items-center gap-4 px-3 py-3 text-base font-medium transition-all border-b border-gray-50 dark:border-gray-800/50 #{params[:view] == 'favorites' ? 'bg-brand-primary/5 dark:bg-amber-500/5 text-brand-primary dark:text-amber-500 border-brand-primary/10 dark:border-amber-500/10' : 'text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 hover:text-gray-700 dark:hover:text-gray-100'}" do %>
        <%= lucide_icon "heart", class: "size-5 #{params[:view] == 'favorites' ? 'text-brand-primary dark:text-amber-500' : 'text-gray-400 dark:text-gray-500'}", stroke_width: (params[:view] == 'favorites' ? 2.5 : 2) %>
        <span>Favorites</span>
      <% end %>

      <%# Meal Plan - Placeholder %>
      <button
        disabled
        class="w-full flex items-center gap-4 px-3 py-3 text-base font-medium transition-all border-b border-gray-50 dark:border-gray-800/50 text-gray-400 dark:text-gray-500 opacity-50 cursor-not-allowed"
      >
        <%= lucide_icon "calendar", class: "size-5 text-gray-400 dark:text-gray-500", stroke_width: 2 %>
        <span>Meal Plan</span>
      </button>

      <%# Shopping List - Placeholder %>
      <button
        disabled
        class="w-full flex items-center gap-4 px-3 py-3 text-base font-medium transition-all border-b border-gray-50 dark:border-gray-800/50 text-gray-400 dark:text-gray-500 opacity-50 cursor-not-allowed"
      >
        <%= lucide_icon "shopping-cart", class: "size-5 text-gray-400 dark:text-gray-500", stroke_width: 2 %>
        <span>Shopping List</span>
      </button>

      <%# Divider %>
      <div class="my-2 border-t border-gray-100 dark:border-gray-800"></div>

      <%# Create New Recipe %>
      <%= link_to new_recipe_path,
        data: { action: "click->mobile-nav#closeSidebar" },
        class: "w-full flex items-center gap-4 px-3 py-3 text-base font-medium transition-all text-gray-600 dark:text-gray-300 hover:bg-gray-50 dark:hover:bg-gray-800 hover:text-gray-700 dark:hover:text-gray-100" do %>
        <%= lucide_icon "plus", class: "size-5 text-gray-400 dark:text-gray-500", stroke_width: 2 %>
        <span>Create New Recipe</span>
      <% end %>
    </div>

    <%# User Profile Section with Logout %>
    <div class="p-3 border-t border-border-subtle dark:border-gray-800 bg-gray-50 dark:bg-gray-900">
      <div class="flex items-center gap-3">
        <div class="w-10 h-10 rounded-full bg-gray-200 dark:bg-gray-700 flex items-center justify-center overflow-hidden border border-gray-300 dark:border-gray-600">
          <%= lucide_icon "user", class: "size-5 text-gray-500 dark:text-gray-400" %>
        </div>
        <div class="flex-1 min-w-0">
          <div class="font-bold text-gray-900 dark:text-gray-100 text-sm truncate">Account</div>
          <div class="text-xs text-gray-500 dark:text-gray-400 truncate"><%= Current.user&.email_address %></div>
        </div>
        <%= button_to session_path, method: :delete,
            class: "p-2 text-gray-400 dark:text-gray-500 hover:text-gray-600 dark:hover:text-gray-300 transition-colors",
            title: "Log Out",
            data: { controller: "logout", action: "click->logout#clearCache" } do %>
          <%= lucide_icon "log-out", class: "size-5" %>
        <% end %>
      </div>
    </div>
  </div>
</div>
